<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Berezhany Live Weather</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --blue: #8ab4f8; --amber: #ff9800; --bg: #0b1120; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; display: flex; justify-content: center; padding: 20px 5px; }
        .snow-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; background: url('https://www.transparenttextures.com/patterns/snow.png'); animation: snow 25s linear infinite; opacity: 0.15; z-index: 1; }
        @keyframes snow { from { background-position: 0 0; } to { background-position: 500px 1000px; } }
        .app-container { position: relative; z-index: 10; width: 100%; max-width: 500px; background: rgba(25, 25, 30, 0.98); backdrop-filter: blur(20px); border-radius: 30px; padding: 25px; border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 15px 50px rgba(0,0,0,0.6); }
        .storm-active { border-color: var(--amber) !important; animation: warning-glow 2s infinite; }
        @keyframes warning-glow { 50% { box-shadow: 0 0 30px rgba(255, 152, 0, 0.4); border-color: var(--amber); } }
        .header { display: flex; justify-content: space-between; margin-bottom: 20px; }
        .refresh-btn { background: rgba(255,255,255,0.1); border: none; color: white; width: 42px; height: 42px; border-radius: 50%; cursor: pointer; }
        .advice { background: rgba(138, 180, 248, 0.1); padding: 15px; border-radius: 18px; border-left: 5px solid var(--blue); margin-bottom: 20px; font-size: 0.88rem; }
        .astro-row { display: flex; gap: 10px; margin-bottom: 20px; }
        .astro-box { flex: 1; background: rgba(255,255,255,0.05); padding: 12px; border-radius: 18px; font-size: 0.75rem; }
        .hero { display: flex; align-items: center; gap: 20px; margin: 15px 0; }
        .temp-main { font-size: 5rem; font-weight: 200; }
        .press-box { background: rgba(0,0,0,0.3); border-radius: 20px; padding: 15px; margin: 15px 0; }
        .tabs { display: flex; justify-content: flex-end; gap: 8px; border-bottom: 1px solid #333; padding-bottom: 12px; margin-bottom: 20px; }
        .tab-btn { background: none; border: 1px solid #444; color: #888; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 0.85rem; }
        .tab-btn.active { background: var(--blue); color: black; border-color: var(--blue); font-weight: bold; }
        .hourly { display: flex; overflow-x: auto; gap: 25px; padding-bottom: 15px; scrollbar-width: none; }
        .h-card { text-align: center; min-width: 60px; }
        .weekly { background: rgba(0,0,0,0.25); border-radius: 25px; padding: 10px 15px; }
        .w-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #333; font-size: 0.9rem; }
    </style>
</head>
<body>
    <div class="snow-bg"></div>
    <div class="app-container" id="main-app">
        <div class="header">
            <div><b style="font-size:1.2rem;">–ë–µ—Ä–µ–∂–∞–Ω–∏ (LIVE)</b><br><small id="current-date"></small></div>
            <button class="refresh-btn" onclick="fetchWeather()"><i class="fa-solid fa-rotate"></i></button>
        </div>
        <div class="advice" id="advice-msg">–û—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–≤—ñ–∂–∏—Ö –¥–∞–Ω–∏—Ö...</div>
        <div class="astro-row">
            <div class="astro-box">üåÖ <span id="sunrise">--:--</span> | üåá <span id="sunset">--:--</span></div>
            <div class="astro-box">üåô –ú—ñ—Å—è—Ü—å: <span id="moon-phase">--</span></div>
        </div>
        <div class="hero">
            <div class="temp-main" id="main-temp">--¬∞</div>
            <i class="fa-solid fa-snowflake" id="main-icon" style="font-size: 3.5rem; color: var(--blue);"></i>
        </div>
        <div id="condition-text" style="font-size: 1.4rem; margin-bottom: 5px;">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
        <div class="press-box">
            <span><i class="fa-solid fa-gauge-high"></i> –¢–∏—Å–∫: <span id="pressure">---</span> –º–º —Ä—Ç.—Å—Ç.</span>
        </div>
        <div class="tabs">
            <button class="tab-btn active" onclick="updateMode('temp')">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</button>
            <button class="tab-btn" onclick="updateMode('precip')">–û–ø–∞–¥–∏</button>
        </div>
        <div class="hourly" id="hour-list"></div>
        <div style="margin: 25px 0 10px; font-weight: bold; color: var(--blue);">–ü–†–û–ì–ù–û–ó –ù–ê –¢–ò–ñ–î–ï–ù–¨</div>
        <div class="weekly" id="week-list"></div>
    </div>

    <script>
        let weatherData = null;

        async function fetchWeather() {
            document.getElementById('advice-msg').innerText = "–û–Ω–æ–≤–ª—é—é –¥–∞–Ω—ñ –∑ –º–µ—Ç–µ–æ—Å—Ç–∞–Ω—Ü—ñ—ó...";
            try {
                // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –ë–µ—Ä–µ–∂–∞–Ω: 49.44, 24.93
                const response = await fetch('https://api.open-meteo.com/v1/forecast?latitude=49.44&longitude=24.93&current=temperature_2m,relative_humidity_2m,is_day,precipitation,weather_code,surface_pressure&hourly=temperature_2m,precipitation_probability,precipitation,weather_code&daily=weather_code,temperature_2m_max,temperature_2m_min,sunrise,sunset&timezone=auto');
                weatherData = await response.json();
                renderWeather();
            } catch (error) {
                document.getElementById('advice-msg').innerText = "–ü–æ–º–∏–ª–∫–∞ –º–µ—Ä–µ–∂—ñ. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑'—î–¥–Ω–∞–Ω–Ω—è.";
            }
        }

        function renderWeather() {
            const current = weatherData.current;
            const daily = weatherData.daily;
            
            document.getElementById('current-date').innerText = new Date().toLocaleDateString('uk-UA', { weekday: 'long', day: 'numeric', month: 'long' });
            document.getElementById('main-temp').innerText = Math.round(current.temperature_2m) + "¬∞";
            document.getElementById('pressure').innerText = Math.round(current.surface_pressure * 0.750062); // –ø–µ—Ä–µ–≤—ñ–¥ —É –º–º —Ä—Ç.—Å—Ç.
            document.getElementById('sunrise').innerText = daily.sunrise[0].split('T')[1];
            document.getElementById('sunset').innerText = daily.sunset[0].split('T')[1];
            
            // –õ–æ–≥—ñ–∫–∞ –ø–æ—Ä–∞–¥–∏
            if (current.precipitation > 0) {
                document.getElementById('main-app').classList.add('storm-active');
                document.getElementById('advice-msg').innerHTML = "<b>–£–í–ê–ì–ê:</b> –£ –ë–µ—Ä–µ–∂–∞–Ω–∞—Ö –∑–∞—Ä–∞–∑ –æ–ø–∞–¥–∏. –û–¥—è–≥–∞–π—Ç–µ—Å—è —Ç–µ–ø–ª–æ —Ç–∞ –±—É–¥—å—Ç–µ –æ–±–µ—Ä–µ–∂–Ω—ñ –Ω–∞ –¥–æ—Ä–æ–≥–∞—Ö!";
            } else {
                document.getElementById('main-app').classList.remove('storm-active');
                document.getElementById('advice-msg').innerText = "–ü–æ–≥–æ–¥–∞ —Å—Ç–∞–±—ñ–ª—å–Ω–∞. –ì–∞—Ä–Ω–æ–≥–æ –¥–Ω—è!";
            }

            // –†–µ–Ω–¥–µ—Ä —Ç–∏–∂–Ω—è
            const weekCont = document.getElementById('week-list');
            weekCont.innerHTML = '';
            for (let i = 0; i < 7; i++) {
                weekCont.innerHTML += `<div class="w-row">
                    <span>${new Date(daily.time[i]).toLocaleDateString('uk-UA', {weekday: 'short'})}</span>
                    <span>${Math.round(daily.temperature_2m_max[i])}¬∞ / ${Math.round(daily.temperature_2m_min[i])}¬∞</span>
                </div>`;
            }
            updateMode('temp');
        }

        function updateMode(mode) {
            const list = document.getElementById('hour-list');
            list.innerHTML = '';
            for (let i = 0; i < 12; i++) {
                const time = weatherData.hourly.time[i].split('T')[1];
                let val = mode === 'temp' ? Math.round(weatherData.hourly.temperature_2m[i]) + "¬∞" : weatherData.hourly.precipitation_probability[i] + "%";
                list.innerHTML += `<div class="h-card"><div>${time}</div><br><b>${val}</b></div>`;
            }
        }

        window.onload = fetchWeather;
    </script>
</body>
</html>
